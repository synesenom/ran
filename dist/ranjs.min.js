// https://synesenom.github.io/ran/ v1.11.4 Copyright 2019 Enys Mones
!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s((t=t||self).ranjs={})}(this,function(t){"use strict";function s(t,s=1){return s<2?t():Array.from({length:s},()=>t())}class e{constructor(t){this._state=t||[Math.random()*Number.MAX_SAFE_INTEGER>>>0,2,3,4]}static hash(t){if(0===t.length)return 0;let s=0;for(let e=0;e<t.length;e++)s=(s<<5)-s+t.charCodeAt(e),s|=0;return s}next(){let t=this._state[1]<<9,s=this._state[0]+this._state[3];return this._state[2]=this._state[2]^this._state[0],this._state[3]=this._state[3]^this._state[1],this._state[1]=this._state[1]^this._state[2],this._state[0]=this._state[0]^this._state[3],this._state[2]=this._state[2]^t,this._state[3]=this._state[3]<<11|this._state[3]>>>21,(s>>>0)/4294967296}seed(t){this._state=[("number"==typeof t?t:e.hash(t))>>>0,2,3,4];for(let t=0;t<100;t++)this.next()}load(t){this._state=t}save(){return this._state}}const h=new e;var a=Object.freeze({Xoshiro128p:e,seed:t=>h.seed(t),float:function(t,e,a){return 0===arguments.length?h.next():1===arguments.length?h.next()*t:s(()=>h.next()*(e-t)+t,a)},int:function(t,e,a){return 1===arguments.length?Math.floor(h.next()*(t+1)):s(()=>Math.floor(h.next()*(e-t+1)+t),a)},choice:function(t,e){if(t)return s(()=>t[Math.floor(h.next()*t.length)],e)},char:function(t,e){if(t)return s(()=>t.charAt(Math.floor(h.next()*t.length)),e)},shuffle:function(t){let s,e,a=t.length;for(;a;)s=Math.floor(h.next()*a--),e=t[a],t[a]=t[s],t[s]=e;return t},coin:function(t,e,a=.5,i=1){return s(()=>h.next()<a?t:e,i)}});class i{constructor(t){"number"==typeof t?(this._v=new Array(t).fill(0),this._v[0]=1):Array.isArray(t)?this._v=t:"object"==typeof t&&Array.isArray(t._v)?this._v=t._v:this._v=[1,0,0]}v(){return this._v}i(t,s){if(void 0===s)return this._v[t];this._v[t]=s}f(t){return new i(this._v.map(s=>t(s)))}scale(t){return new i(this._v.map(s=>s*t))}add(t){let s=t.v();return new i(this._v.map((t,e)=>t+s[e]))}dot(t){let s=t.v();return this._v.reduce((t,e,h)=>t+e*s[h],0)}}class r{constructor(t){if("number"==typeof t){this._m=Array.from({length:t},()=>new Array(t).fill(0));for(let s=0;s<t;s++)this._m[s][s]=1}else Array.isArray(t)?this._m=t:"object"==typeof t&&Array.isArray(t._m)?this._m=t._m:this._m=[[1,0,0],[0,1,0],[0,0,1]]}m(){return this._m.map(t=>t.slice())}ij(t,s,e){if(void 0===e)return this._m[t][s];this._m[t][s]=e}f(t){return new r(this._m.map(s=>s.map(s=>t(s))))}scale(t){return this.f(s=>s*t)}add(t){let s=t.m();return new r(this._m.map((t,e)=>t.map((t,h)=>t+s[e][h])))}mult(t){let s=t.m(),e=this._m.length,h=new r(e);for(let t=0;t<e;t++)for(let a=0;a<e;a++){let i=0;for(let h=0;h<e;h++)i+=this._m[t][h]*s[h][a];h.ij(t,a,i)}return h}t(){return new r(this._m[0].map((t,s)=>this._m.map(t=>t[s])))}act(t){return new i(this._m.map(s=>t.dot(new i(s))))}ldl(){let t=this._m.length,s=new r(t),e=new r(t);for(let h=0;h<t;h++){let a=this.ij(h,h);for(let t=0;t<h;t++)a-=s.ij(t,t)*e.ij(h,t)*e.ij(h,t);s.ij(h,h,a);for(let i=t-1;i>h;i--){let t=this.ij(i,h);for(let a=0;a<h;a++)t-=s.ij(a,a)*e.ij(i,a)*e.ij(h,a);e.ij(i,h,t/a)}}return{D:s,L:e}}}var p=Object.freeze({Vector:i,Matrix:r});function n(t){let s=t[0],e=0;for(let h=1;h<t.length;h++){let a=s+t[h];Math.abs(s)>Math.abs(t[h])?e+=s-a+t[h]:e+=t[h]-a+s,s=a}return s+e}const l=[0,6.635,9.21,11.345,13.277,15.086,16.812,18.475,20.09,21.666,23.209,24.725,26.217,27.688,29.141,30.578,32,33.409,34.805,36.191,37.566,38.932,40.289,41.638,42.98,44.314,45.642,46.963,48.278,49.588,50.892,52.191,53.486,54.776,56.061,57.342,58.619,59.893,61.162,62.428,63.691,64.95,66.206,67.459,68.71,69.957,71.201,72.443,73.683,74.919,76.154,77.386,78.616,79.843,81.069,82.292,83.513,84.733,85.95,87.166,88.379,89.591,90.802,92.01,93.217,94.422,95.626,96.828,98.028,99.228,100.425,101.621,102.816,104.01,105.202,106.393,107.583,108.771,109.958,111.144,112.329,113.512,114.695,115.876,117.057,118.236,119.414,120.591,121.767,122.942,124.116,125.289,126.462,127.633,128.803,129.973,131.141,132.309,133.476,134.642,135.807,136.971,138.134,139.297,140.459,141.62,142.78,143.94,145.099,146.257,147.414,148.571,149.727,150.882,152.037,153.191,154.344,155.496,156.648,157.8,158.95,160.1,161.25,162.398,163.546,164.694,165.841,166.987,168.133,169.278,170.423,171.567,172.711,173.854,174.996,176.138,177.28,178.421,179.561,180.701,181.84,182.979,184.118,185.256,186.393,187.53,188.666,189.802,190.938,192.073,193.208,194.342,195.476,196.609,197.742,198.874,200.006,201.138,202.269,203.4,204.53,205.66,206.79,207.919,209.047,210.176,211.304,212.431,213.558,214.685,215.812,216.938,218.063,219.189,220.314,221.438,222.563,223.687,224.81,225.933,227.056,228.179,229.301,230.423,231.544,232.665,233.786,234.907,236.027,237.147,238.266,239.386,240.505,241.623,242.742,243.86,244.977,246.095,247.212,248.329,249.445,250.561,251.677,252.793,253.908,255.023,256.138,257.253,258.367,259.481,260.595,261.708,262.821,263.934,265.047,266.159,267.271,268.383,269.495,270.606,271.717,272.828,273.939,275.049,276.159,277.269,278.379,279.488,280.597,281.706,282.814,283.923,285.031,286.139,287.247,288.354,289.461,290.568,291.675,292.782,293.888,294.994,296.1,297.206,298.311,299.417,300.522,301.626,302.731,303.835,304.94],u=[359.906,414.474,468.724,522.717,576.493,630.084,683.516,736.807,789.974,843.029,895.984,948.848,1001.63,1054.334,1106.969];const o=100,c=Number.EPSILON,d=1e-30,M=1.6;class _{constructor(t,s){this.t=t,this.k=s,this.p={},this.s=[],this.r=new e,this._cdfTable=[]}_validate(t,s){if(s.filter(s=>{let e=s;for(let s in t)t.hasOwnProperty(s)&&(e=e.replace(new RegExp(`(${s} | ${s})`),t[s]));return!new Function(`return ${e}`)()}).length>0)throw Error(`Invalid parameters. Parameters must satisfy the following constraints: ${s.join(", ")}`)}_generator(){throw Error("Distribution._generator() is not implemented")}_pdf(t){throw Error("Distribution._pdf() is not implemented")}_cdf(t){throw Error("Distribution._cdf() is not implemented")}_qEstimateTable(t){let s=this.s[0].value,e=this.s[1].closed?this.s[1].value+1:1e6;for(0===this._cdfTable.length&&this._cdfTable.push(this.cdf(s));s<e;s++)if(this._cdfTable.length===s&&this._cdfTable.push(this.cdf(s)),t<this._cdfTable[s])return s}_qEstimateRoot(t,s){let e=((Number.isFinite(this.s[1].value)?this.s[1].value:10)-(Number.isFinite(this.s[0].value)?this.s[0].value:1))/1e3,h=Math.random();void 0!==s?h=s-e*Math.random():this.s[0].closed?h=this.s[0].value+e*Math.random():Number.isFinite(this.s[0].value)&&(h=this.s[0].value+e*Math.random());let a=h+Math.random();void 0!==s?a=s+e*Math.random():this.s[1].closed?a=this.s[1].value-e*Math.random():Number.isFinite(this.s[1].value)&&(a=this.s[1].value-e*Math.random());let i=function(t,s,e,h){if(s===e)return;let a=Math.min(s,e),i=h?h[0].value:-1/0,r=h&&h[0].closed?0:1,p=Math.max(s,e),n=h?h[1].value:1/0,l=h&&h[1].closed?0:1,u=t(a),c=t(p);for(let s=0;s<o;s++){if(u*c<0)return[a,p];Math.abs(u)<Math.abs(c)?(a=Math.max(a+M*(a-p),i+r),r/=M,u=t(a)):(p=Math.min(p+M*(p-a),n-l),l/=M,c=t(p))}}(s=>this.cdf(s)-t,h,a,this.s);return void 0!==i?function(t,s,e){let h,a,i,r,p,n,l,u,d,M=s,_=e,m=e,g=t(M),f=t(_);if(!(g>0&&f>0||g<0&&f<0)){i=f;for(let s=0;s<o;s++){if((f>0&&i>0||f<0&&i<0)&&(m=M,i=g,a=h=_-M),Math.abs(i)<Math.abs(f)&&(M=_,_=m,m=M,g=f,f=i,i=g),u=c*(2*Math.abs(_)+.5),d=.5*(m-_),Math.abs(d)<=u||0===f)return _;if(Math.abs(a)>=u&&Math.abs(g)>Math.abs(f)){l=f/g,M===m?(r=2*d*l,p=1-l):(r=l*(2*d*(p=g/i)*(p-(n=f/i))-(_-M)*(n-1)),p=(p-1)*(n-1)*(l-1)),r>0&&(p=-p),r=Math.abs(r);let t=3*d*p-Math.abs(u*p),s=Math.abs(a*p);2*r<(t<s?t:s)?(a=h,h=r/p):a=h=d}else a=h=d;M=_,g=f,Math.abs(h)>u?_+=h:_+=u*Math.sign(d),f=t(_)}}}(s=>this.cdf(s)-t,...i):void 0}type(){return this.t}support(){return this.s}seed(t){return this.r.seed(t),this}save(){return{prngState:this.r.save(),params:this.p,consts:this.c,support:this.s}}load(t){return this.p=t.params,this.c=t.consts,this.s=t.support,this.r.load(t.prngState),this}sample(t=1){return s(()=>this._generator(),t)}pdf(t){let s="discrete"===this.t?Math.round(t):t;return this.s[0].closed&&s<this.s[0].value||!this.s[0].closed&&s<=this.s[0].value?0:this.s[1].closed&&s>this.s[1].value||!this.s[1].closed&&s>=this.s[1].value?0:this._pdf(s)}cdf(t){let s="discrete"===this.t?Math.round(t):t;return this.s[0].closed&&s<this.s[0].value||!this.s[0].closed&&s<=this.s[0].value?0:s>=this.s[1].value?1:this._cdf(s)}q(t){return t<0||t>1?void 0:0===t?this.s[0].value:1===t?this.s[1].value:"function"==typeof this._q?this._q(t):"discrete"===this.t?this._qEstimateTable(t):this._qEstimateRoot(t)}survival(t){return 1-this._cdf(t)}hazard(t){return this._pdf(t)/this.survival(t)}cHazard(t){return-Math.log(this.survival(t))}lnPdf(t){return Math.log(this._pdf(t))}lnL(t){return n(t.map(t=>this.lnPdf(t)).sort((t,s)=>s-t))}aic(t){return 2*(this.k-this.lnL(t))}bic(t){return Math.log(t.length)*this.k-2*this.lnL(t)}test(t){return"discrete"===this.t?function(t,s,e){let h=new Map;t.forEach(function(t){h.set(t,h.has(t)?h.get(t)+1:1)});let a=0,i=0,r=0,p=0;h.forEach((e,h)=>{i+=s(parseInt(h))*t.length,r+=e,i>20&&(a+=Math.pow(r-i,2)/i,i=0,r=0,p++)});let n=Math.max(1,p-e-1),o=n<=250?l[n]:u[Math.floor(n/50)];return{statistics:a,passed:a<=o}}(t,t=>this._pdf(t),this.k):function(t,s){t.sort((t,s)=>t-s);let e=0;for(let h=0;h<t.length;h++)e=Math.max(e,Math.abs((h+1)/t.length-s(t[h])));return{statistics:e,passed:e<=1.628/Math.sqrt(t.length)}}(t,t=>this._cdf(t))}}const m=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];function g(t){let s=t,e=t,h=s+5.5;h=(s+.5)*Math.log(h)-h;let a=1.000000000190015;for(let t=0;t<6;t++)e++,a+=m[t]/e;return h+Math.log(2.5066282746310007*a/s)}class f extends _{constructor(t=1){super("continuous",arguments.length),this.p={n:Math.round(t)},this._validate({n:Math.round(t)},["n > 0"]),this.s=[{value:0,closed:!0},{value:t,closed:!0}],this.c=Array.from({length:t+1},(s,e)=>g(e+1)+g(t-e+1))}_generator(){return n(Array.from({length:this.p.n},()=>this.r.next()))}_pdf(t){let s=t<this.p.n/2?t:this.p.n-t,e=Array.from({length:Math.floor(s)+1},(t,e)=>{let h=(this.p.n-1)*Math.log(s-e)-this.c[e];return e%2==0?Math.exp(h):-Math.exp(h)});return e.sort((t,s)=>Math.abs(t)-Math.abs(s)),this.p.n*n(e)}_cdf(t){let s=t<this.p.n/2?t:this.p.n-t,e=Array.from({length:Math.floor(s)+1},(t,e)=>{let h=this.p.n*Math.log(s-e)-this.c[e];return e%2==0?Math.exp(h):-Math.exp(h)});return e.sort((t,s)=>Math.abs(t)-Math.abs(s)),t<this.p.n/2?n(e):1-n(e)}}function x(t){let s=t<1?0:Math.log(Math.max(t,d)),e=0;for(let h=0;h<o;h++){let h=s*Math.exp(s)-t;if(s-=e=h/((s+1)*Math.exp(s)-(s+2)*h/(2*s+2)),Math.abs(e/s)<c)break}return s}class b extends _{constructor(t=[1],s=0){super("discrete",arguments.length),this.p={n:t.length,weights:t,min:s},this._validate({w_i:t.reduce((t,s)=>t*s,1),min:s},["w_i >= 0"]),this.s=[{value:s,closed:!0},{value:Math.max(0,t.length-1)+s,closed:!0}];let e=t.length,h=[0],a=[0],i=0;if(t.length>1){for(let s=0;s<e;s++)i+=t[s];let s=[],r=[],p=[];for(let h=0;h<e;h++)s.push(e*t[h]/i),s[h]<1?r.push(h):p.push(h);h=[],a=[];for(let t=0;t<e;t++)h.push(1),a.push(t);let n=0,l=0;for(;r.length>0&&p.length>0;)n=r.shift(),l=p.shift(),h[n]=s[n],a[n]=l,s[l]+=s[n]-1,s[l]<1?r.push(l):p.push(l);for(;p.length>0;)h[l=p.shift()]=1,a[l]=l;for(;r.length>0;)h[n=r.shift()]=1,a[n]=n}let r=[t[0]/i],p=[t[0]/i];for(let s=1;s<t.length;s++)r.push(t[s]/i),p.push(p[s-1]+t[s]/i);this.c=[h,a,r,p]}_generator(){if(this.p.n<=1)return this.p.min;let t=Math.floor(this.r.next()*this.p.n);return this.r.next()<this.c[0][t]?t+this.p.min:this.c[1][t]+this.p.min}_pdf(t){return this.p.n<=1?1:this.c[2][t-this.p.min]}_cdf(t){return this.c[3][t-this.p.min]}}function v(t,s){return Math.exp(g(t)+g(s)-g(t+s))}function w(t,s,e){let h=t+s,a=t+1,i=t-1,r=1,p=1-h*e/a,n=p=1/(p=Math.max(Math.abs(p),d));for(let l=1;l<o;l++){let u=2*l,o=l*(s-l)*e/((i+u)*(t+u));p=1+o*p,r=1+o/r,n*=(p=1/(p=Math.max(Math.abs(p),d)))*(r=Math.max(Math.abs(r),d)),p=1+(o=-(t+l)*(h+l)*e/((t+u)*(a+u)))*p,r=1+o/r;let M=(p=1/(p=Math.max(Math.abs(p),d)))*(r=Math.max(Math.abs(r),d));if(n*=M,Math.abs(M-1)<c)break}return n}function q(t,s,e){let h=e<=0||e>=1?0:Math.exp(g(t+s)-g(t)-g(s)+t*Math.log(e)+s*Math.log(1-e));return e<(t+1)/(t+s+2)?h*w(t,s,e)/t:1-h*w(s,t,1-e)/s}function y(t,s,e,h){for(let a=0;a<1e3;a++){let a=s();if(t.next()<e(a))return void 0!==h?h(a):a}}function k(t,s,e=1){if(!(s>1))return k(t,s+1,e)*Math.pow(t.next(),1/s);{let h,a,i,r=s-1/3,p=1/Math.sqrt(9*r);for(let s=0;s<1e3;s++)if((h=I(t))>-1/p&&(a=Math.pow(1+p*h,3),i=t.next(),Math.log(i)<.5*h*h+r*(1-a+Math.log(a))))return r*a/e}}function I(t,s=0,e=1){let h=t.next(),a=t.next();return e*Math.sqrt(-2*Math.log(h))*Math.cos(2*Math.PI*a)+s}function P(t,s){if(s<30){let e=Math.exp(-s),h=0,a=1;do{h++,a*=t.next()}while(a>e);return h-1}{let e=.767-3.36/s,h=Math.PI/Math.sqrt(3*s),a=h*s,i=Math.log(e)-s-Math.log(h);for(let e=0;e<1e3;e++){let e,r,p;do{e=t.next(),r=(a-Math.log((1-e)/e))/h,p=Math.floor(r+.5)}while(p<0);let n=t.next(),l=a-h*r;if(l+Math.log(n/Math.pow(1+Math.exp(l),2))<=i+p*Math.log(s)-g(p+1))return p}}}function A(t,s){let e=Math.pow(2,s-1);for(let h=0;h<100;h++){let h=Math.floor(Math.pow(t.next(),-1/(s-1))),a=Math.pow(1+1/h,s-1);if(t.next()*h*(a-1)/(e-1)<=a/e)return h}}class R extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={alpha:t,beta:s},this._validate({alpha:t,beta:s},["alpha > 0","beta > 0"]),this.s=[{value:0,closed:!0},{value:1,closed:!0}],this.c=[v(t,s)]}_generator(){let t=k(this.r,this.p.alpha,1),s=k(this.r,this.p.beta,1),e=t/(t+s);return 1===e?1-s/t:e}_pdf(t){let s=Math.pow(t,this.p.alpha-1),e=Math.pow(1-t,this.p.beta-1);return isFinite(s)&&isFinite(e)?s*e/this.c[0]:0}_cdf(t){return q(this.p.alpha,this.p.beta,t)}}function L(t,s){return g(t+1)-g(s+1)-g(t-s+1)}function j(t,s){if(s<0)return 0;{let e=t,h=1/t,a=h;for(let t=0;t<o&&(a+=h*=s/++e,!(Math.abs(h)<Math.abs(a)*c));t++);return a*Math.exp(-s+t*Math.log(s)-g(t))}}function E(t,s){let e,h,a=s+1-t,i=1/d,r=1/a,p=r;for(let s=1;s<o&&(r=(e=s*(t-s))*r+(a+=2),r=1/(r=Math.max(Math.abs(r),d)),i=a+e/i,p*=h=(i=Math.max(Math.abs(i),d))*r,!(Math.abs(h-1)<c));s++);return p*Math.exp(-s+t*Math.log(s)-g(t))}function N(t,s){return s<t+1?j(t,s):1-E(t,s)}function S(t,s){return s<t+1?1-j(t,s):E(t,s)}function F(t,s,e){let h,a,i=e;for(let e=0;e<o&&(a=s(i),i-=h=t(i)/(0!==a?a:s(i+Number.EPSILON)),!(Math.abs(h/i)<c));e++);return i}const O=[.0833333333333333,.0145833333333333,.0031498015873016,.00075248704806,.0001907475361251];function C(t){return t<0?-N(.5,t*t):N(.5,t*t)}function T(t){return t<0?1+N(.5,t*t):S(.5,t*t)}function H(t){let s=0,e=.5*Math.pow(Math.PI,5.5);for(let h=O.length-1;h>=0;h--)s=(s+O[h]*e)*t*t,e/=Math.PI;return F(s=>C(s)-t,t=>2*Math.exp(-t*t)/Math.sqrt(Math.PI),s=(s+1)*t)}class z extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,sigma:s},this._validate({mu:t,sigma:s},["sigma > 0"]),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}],this.c=[s*Math.sqrt(2*Math.PI),s*Math.SQRT2]}_generator(){return I(this.r,this.p.mu,this.p.sigma)}_pdf(t){return Math.exp(-.5*Math.pow((t-this.p.mu)/this.p.sigma,2))/this.c[0]}_cdf(t){return.5*(1+C((t-this.p.mu)/this.c[1]))}_q(t){return this.p.mu+this.c[1]*H(2*t-1)}}class B extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={x0:t,gamma:s},this._validate({x0:t,gamma:s},["gamma > 0"]),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}],this.c=[Math.PI*this.p.gamma]}_generator(){return this.p.x0+this.p.gamma*Math.tan(Math.PI*(this.r.next()-.5))}_pdf(t){let s=(t-this.p.x0)/this.p.gamma;return 1/(this.c[0]*(1+s*s))}_cdf(t){return.5+Math.atan2(t-this.p.x0,this.p.gamma)/Math.PI}_q(t){return this.p.x0+this.p.gamma*Math.tan(Math.PI*(t-.5))}}class G extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={alpha:t,beta:s},this._validate({alpha:t,beta:s},["alpha > 0","beta > 0"]),this.s=[{value:0,closed:t>=1},{value:1/0,closed:!1}]}_generator(){return k(this.r,this.p.alpha,this.p.beta)}_pdf(t){return Math.exp(this.p.alpha*Math.log(this.p.beta)-this.p.beta*t-g(this.p.alpha))*Math.pow(t,this.p.alpha-1)}_cdf(t){return N(this.p.alpha,this.p.beta*t)}}class D extends G{constructor(t=2){super(Math.round(t)/2,.5),this._validate({k:t},["k > 0"])}}class Q extends _{constructor(t=1,s=1,e=1){super("continuous",arguments.length),this.p={p:t,a:s,b:e},this._validate({p:t,a:s,b:e},["p > 0","a > 0","b > 0"]),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=Math.pow(t/this.p.b,this.p.a);return this.p.a*this.p.p*Math.pow(s,this.p.p)/(t*Math.pow(s+1,this.p.p+1))}_cdf(t){return Math.pow(1+Math.pow(t/this.p.b,-this.p.a),-this.p.p)}_q(t){return this.p.b*Math.pow(Math.pow(t,-1/this.p.p)-1,-1/this.p.a)}}class U extends _{constructor(t=1){super("continuous",arguments.length),this.p={lambda:t},this._validate({lambda:t},["lambda > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}],this.c=[Math.exp(-t)]}_generator(){return function(t,s=1){return-Math.log(t.next())/s}(this.r,this.p.lambda)}_pdf(t){return this.p.lambda*Math.pow(this.c[0],t)}_cdf(t){return 1-Math.pow(this.c[0],t)}_q(t){return-Math.log(1-t)/this.p.lambda}}class K extends R{constructor(t=2,s=2){super(t/2,s/2),this.p=Object.assign(this.p,{d1:t,d2:s}),this._validate({d1:t,d2:s},["d1 > 0","d2 > 0"]),this.s=[{value:0,closed:1!==t},{value:1/0,closed:!1}]}_generator(){let t=super._generator();return this.p.d2*t/(this.p.d1*(1-t))}_pdf(t){return this.p.d1*this.p.d2*super._pdf(this.p.d1*t/(this.p.d2+this.p.d1*t))/Math.pow(this.p.d2+this.p.d1*t,2)}_cdf(t){let s=this.p.d1*t;return super._cdf(1/(1+this.p.d2/s))}}class W extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={mu:t,lambda:s},this._validate({mu:t,lambda:s},["mu > 0","lambda > 0"]),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}],this.c=[.5*t/s,Math.exp(2*s/t),Math.sqrt(s/(t*t))]}_generator(){let t=I(this.r),s=t*t,e=this.p.mu+this.c[0]*this.p.mu*s-this.c[0]*Math.sqrt(this.p.mu*s*(4*this.p.lambda+this.p.mu*s));return this.r.next()>this.p.mu/(this.p.mu+e)?this.p.mu*this.p.mu/e:e}_pdf(t){return Math.sqrt(this.p.lambda/(2*Math.PI*Math.pow(t,3)))*Math.exp(-this.p.lambda*Math.pow(t-this.p.mu,2)/(2*this.p.mu*this.p.mu*t))}_cdf(t){let s=Math.sqrt(this.p.lambda/t),e=Math.sqrt(t)*this.c[2],h=C(Math.SQRT1_2*(e-s));return 1-h>Number.EPSILON?Math.min(1,.5*(1+h+this.c[1]*T(Math.SQRT1_2*(e+s)))):Math.min(1,.5*(T(Math.SQRT1_2*(s-e))+this.c[1]*T(Math.SQRT1_2*(e+s))))}}class $ extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={a:t,b:s},this._validate({a:t,b:s},["a > 0","b > 0"]),this.s=[{value:0,closed:!0},{value:1,closed:!0}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=Math.pow(t,this.p.a-1);if(!isFinite(s))return 0;let e=Math.pow(1-s*t,this.p.b-1);return isFinite(e)?this.p.a*this.p.b*s*e:0}_cdf(t){return 1-Math.pow(1-Math.pow(t,this.p.a),this.p.b)}_q(t){return Math.pow(1-Math.pow(1-t,1/this.p.b),1/this.p.a)}}class V extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,b:s},this._validate({mu:t,b:s},["b > 0"]),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}]}_generator(){return this.p.mu+this.p.b*Math.log(this.r.next()/this.r.next())}_pdf(t){return.5*Math.exp(-Math.abs(t-this.p.mu)/this.p.b)/this.p.b}_cdf(t){let s=Math.exp((t-this.p.mu)/this.p.b);return t<this.p.mu?.5*s:1-.5/s}_q(t){return t<.5?this.p.mu+this.p.b*Math.log(2*t):this.p.mu-this.p.b*Math.log(2-2*t)}}function X(t){let s,e,h=Math.abs(t);return h<3.75?(e=t/3.75,s=1+(e*=e)*(3.5156229+e*(3.0899424+e*(1.2067492+e*(.2659732+e*(.0360768+.0045813*e)))))):(e=3.75/h,s=Math.exp(h)/Math.sqrt(h)*(.39894228+e*(.01328592+e*(.00225319+e*(e*(.00916281+e*(e*(.02635537+e*(.00392377*e-.01647633))-.02057706))-.00157565))))),s}function Z(t,s){let e,h,a,i,r;if(0===t)return X(s);if(1===t)return function(t){let s,e,h=Math.abs(t);return h<3.75?(e=t/3.75,s=h*(.5+(e*=e)*(.87890594+e*(.51498869+e*(.15084934+e*(.02658733+e*(.00301532+32411e-8*e))))))):(s=.39894228+(e=3.75/h)*(e*(e*(.00163801+e*(e*(s=.02282967+e*(e*(.01787654-.00420059*e)-.02895312))-.01031555))-.00362018)-.03988024),s*=Math.exp(h)/Math.sqrt(h)),t<0?-s:s}(s);if(0===s)return 0;i=2/Math.abs(s),a=0,r=0,e=1;for(let s=2*(t+Math.round(Math.sqrt(40*t)));s>0;s--)h=a+s*i*e,a=e,e=h,Math.abs(e)>1/c&&(r*=c,e*=c,a*=c),s===t&&(r=a);return r*=X(s)/e,s<0?-r:r}function J(t,s){switch(t){case 0:return 0===s?1:Math.sinh(s)/s;case 1:return 0===s?0:(Math.cosh(s)-Math.sinh(s)/s)/s;default:if(t>0){let e=function(t,s){switch(t){case 0:return Math.exp(-s)/s;case 1:return Math.exp(-s)*(1+1/s)/s;default:let e,h=1+1/s,a=1;for(let i=2;i<=t;i++)e=(i+i-1)*h/s+a,a=h,h=e;return[Math.exp(-s)*e/s,Math.exp(-s)*a/s]}}(t+1,s);return 0===s?0:1/(s*s*(function(t,s){let e=s/(t+t+1),h=e,a=h,i=(t+t+3)/s;for(let t=1;t<o&&(a+=h*=i*(e=1/(i+e))-1,i+=2/s,!(Math.abs(h/a)<c));t++);return a}(t+1,s)*e[1]+e[0]))}return(t+t+3)*J(t+1,s)/s+J(t+2,s)}}const Y={q(t,s,e){let h=1,a=Math.exp((t-1)*Math.log(e)-e-g(t)),i=S(t,e),r=h*i,p=r;for(let n=1;n<o&&!((r=(h*=s/n)*(i+=a*=e/(t+n-1)))/(p+=r)<c);n++);return Math.exp(-s)*p},p(t,s,e){let h=t+g(t)-Math.log(2*Math.PI*c),a=Math.log(s*e),i=s*e,r=F(s=>(s+t)*Math.log(s+t)+s*Math.log(s)-2*s-s*a-h,s=>Math.log(s*(s+t)/i),.5*(Math.sqrt(t*t+4*s*e)-t)+1);r=Math.ceil(r);let p=Math.exp(r*Math.log(s)-g(r+1)),n=Math.exp((t+r)*Math.log(e)-e-g(t+r+1)),l=N(t+r,e),u=p*l,o=u;for(let h=r-1;h>=0;h--)o+=u=(p*=(h+1)/s)*(l+=n*=(t+h+1)/e);return 1-Math.exp(-s)*o}};function tt(t,s,e){let h=e>s+t?"q":"p";return 0===e?1:0===s?S(t,e):Y[h](t,s,e)}class st extends _{constructor(t=2,s=1){super("continuous",arguments.length);let e=Math.round(t);this.p={k:e,lambda:s},this._validate({k:e,lambda:s},["k > 0","lambda > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}],this.c=[this.p.k%2==0]}_generator(){let t=P(this.r,this.p.lambda/2);return k(this.r,this.p.k/2+t,.5)}_pdf(t){return this.c[0]?2===this.p.k&&0===t?.5*Math.exp(-.5*this.p.lambda):.5*Math.exp(-.5*(t+this.p.lambda))*Math.pow(t/this.p.lambda,this.p.k/4-.5)*Z(Math.abs(Math.floor(this.p.k/2)-1),Math.sqrt(this.p.lambda*t)):1===this.p.k&&0===t?.5*Math.exp(-.5*this.p.lambda)*Math.sqrt(2/Math.PI):.5*Math.exp(-.5*(t+this.p.lambda))*Math.pow(t/this.p.lambda,this.p.k/4-.5)*J(Math.floor((this.p.k-3)/2),Math.sqrt(this.p.lambda*t))*Math.sqrt(2*Math.sqrt(t*this.p.lambda)/Math.PI)}_cdf(t){return 1-tt(this.p.k/2,this.p.lambda/2,t/2)}}class et extends U{constructor(t=1,s=1){super(1),this.p=Object.assign(this.p,{lambda2:t,k:s}),this._validate({lambda:t,k:s},["lambda > 0","k > 0"]),this.s=[{value:0,closed:s>=1},{value:1/0,closed:!1}]}_generator(){return this.p.lambda2*Math.pow(super._generator(),1/this.p.k)}_pdf(t){return this.p.k*Math.pow(t/this.p.lambda2,this.p.k-1)*super._pdf(Math.pow(t/this.p.lambda2,this.p.k))/this.p.lambda2}_cdf(t){return super._cdf(Math.pow(t/this.p.lambda2,this.p.k))}_q(t){return this.p.lambda2*Math.pow(-Math.log(1-t),1/this.p.k)}}function ht(t){let s=Math.pow(3+Math.sqrt(8),30),e=-1,h=-(s=(s+1/s)/2),a=0;for(let s=0;s<30;s++){a+=(h=e-h)*Math.pow(s+1,-t),e=(s+30)*(s-30)*e/((s+.5)*(s+1))}return a/s/(1-Math.pow(2,1-t))}const at=[.16666666666666666,-.03333333333333333,.023809523809523808,-.03333333333333333,.07575757575757576,-.2531135531135531,1.1666666666666667,-7.092156862745098,54.971177944862156,-529.1242424242424,6192.123188405797,-86580.25311355312,1425517.1666666667,-27298231.067816094,601580873.9006424,-15116315767.092157,429614643061.1667,-13711655205088.334];function it(t,s){return ht(s)-function(t,s){let e=0;for(let h=0;h<=20;h++)e+=Math.pow(s+h,-t);e+=Math.pow(s+20,1-t)/(t-1)-.5/Math.pow(s+20,t);let h=1;for(let a=1;a<at.length;a++){let i=g(t+4*a-3)-g(t+2*a-2);if(i-=(t+2*a-1)*Math.log(s+20),i-=g(2*a+1),e+=h*=at[a-1]*Math.exp(i),Math.abs(h/e)<c)break}return e}(s,t+1)}var rt=Object.freeze({InvalidDiscrete:class extends _{constructor(){super("discrete",arguments.length),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}]}},Arcsine:class extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={a:t,b:s},this._validate({a:t,b:s},["a < b"]),this.s=[{value:t,closed:!0},{value:s,closed:!0}],this.c=[1/Math.PI,s-t,.5*Math.PI]}_generator(){return this._q(this.r.next())}_pdf(t){return this.c[0]/Math.sqrt((t-this.p.a)*(this.p.b-t))}_cdf(t){return 2*this.c[0]*Math.asin(Math.sqrt((t-this.p.a)/(this.p.b-this.p.a)))}_q(t){let s=Math.sin(this.c[2]*t);return s*s*this.c[1]+this.p.a}},Bates:class extends f{constructor(t=10,s=0,e=1){super(t),this.p=Object.assign(this.p,{a:s,b:e}),this._validate({a:s,b:e,n:t},["n > 0","a < b"]),this.s=[{value:s,closed:!0},{value:e,closed:!0}]}_generator(){return(this.p.b-this.p.a)*super._generator()/this.p.n+this.p.a}_pdf(t){return this.p.n*super._pdf(this.p.n*(t-this.p.a)/(this.p.b-this.p.a))/(this.p.b-this.p.a)}_cdf(t){return super._cdf(this.p.n*(t-this.p.a)/(this.p.b-this.p.a))}},Benini:class extends _{constructor(t=1,s=1,e=1){super("continuous",arguments.length),this.p={alpha:t,beta:s,sigma:e},this._validate({alpha:t,beta:s,sigma:e},["alpha > 0","beta > 0","sigma > 0"]),this.s=[{value:e,closed:!0},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=Math.log(t/this.p.sigma);return Math.exp(-s*(this.p.alpha+this.p.beta*s))*(this.p.alpha+2*this.p.beta*s)/t}_cdf(t){let s=Math.log(t/this.p.sigma);return 1-Math.exp(-s*(this.p.alpha+this.p.beta*s))}_q(t){return this.p.sigma*Math.exp(.5*(Math.sqrt(this.p.alpha*this.p.alpha-4*this.p.beta*Math.log(1-t))-this.p.alpha)/this.p.beta)}},BenktanderII:class extends _{constructor(t=1,s=.5){super("continuous",arguments.length),this.p={a:t,b:s},this._validate({a:t,b:s},["a > 0","b > 0","b <= 1"]),this.s=[{value:1,closed:!0},{value:1/0,closed:!1}],this.c=[(1-s)/t,Math.exp(-t/s),s/(s-1),Math.log(t/(1-s))+t/(1-s)],this.eps=1-s}_generator(){return this._q(this.r.next())}_pdf(t){if(this.eps<Number.EPSILON)return this.p.a*Math.exp(this.p.a*(1-t));let s=Math.pow(t,this.p.b);return Math.exp(this.p.a*(1-s)/this.p.b)*Math.pow(t,this.p.b-2)*(this.p.a*s-this.p.b+1)}_cdf(t){return this.eps<Number.EPSILON?1-Math.exp(this.p.a*(1-t)):1-Math.pow(t,this.p.b-1)*Math.exp(this.p.a*(1-Math.pow(t,this.p.b))/this.p.b)}_q(t){if(this.eps<Number.EPSILON)return 1-Math.log(1-t)/this.p.a;let s=x(Math.pow(this.c[1]*(1-t),this.c[2])/this.c[0]);if(isFinite(s))return Math.pow(this.c[0]*s,1/this.p.b);{let s=this.c[3]+this.c[2]*Math.log(1-t),e=Math.log(s);return Math.pow(this.c[0]*(s-e+e/s),1/this.p.b)}}},Bernoulli:class extends b{constructor(t=.5){super([1-t,t]),this._validate({p:t},["p >= 0","p <= 1"])}_q(t){return t>1-this.p.p?1:0}},Beta:R,BetaPrime:class extends R{constructor(t=2,s=2){super(t,s),this.s=[{value:0,closed:t>=1},{value:1/0,closed:!1}]}_generator(){return k(this.r,this.p.alpha,1)/k(this.r,this.p.beta,1)}_pdf(t){return super._pdf(t/(1+t))/Math.pow(1+t,2)}_cdf(t){return super._cdf(t/(1+t))}},BetaRectangular:class extends R{constructor(t=1,s=1,e=.5,h=0,a=1){super(t,s),this.p=Object.assign(this.p,{theta:e,a:h,b:a}),this._validate({theta:e,a:h,b:a},["theta >= 0","theta <= 1","a < b"]),this.s=[{value:h,closed:!0},{value:a,closed:!0}]}_generator(){return this.r.next()<this.p.theta?super._generator()*(this.p.b-this.p.a)+this.p.a:this.r.next()*(this.p.b-this.p.a)+this.p.a}_pdf(t){return this.p.theta*super._pdf((t-this.p.a)/(this.p.b-this.p.a))/(this.p.b-this.p.a)+(1-this.p.theta)/(this.p.b-this.p.a)}_cdf(t){return this.p.theta*super._cdf((t-this.p.a)/(this.p.b-this.p.a))+(1-this.p.theta)*(t-this.p.a)/(this.p.b-this.p.a)}},Binomial:class extends _{constructor(t=100,s=.5){super("discrete",arguments.length);let e=s<=.5?s:1-s;this.p={n:Math.round(t),p:s},this._validate({n:t,p:s},["n >= 0","p >= 0","p <= 1"]),this.s=[{value:0,closed:!0},{value:this.p.n,closed:!0}],this.c=[e,this.p.n*e]}_generator(){if(this.p.n<25){let t=0;for(let s=1;s<=this.p.n;s++)this.r.next()<this.c[0]&&t++;return this.c[0]===this.p.p?t:this.p.n-t}if(this.c[1]<1){let t,s=Math.exp(-this.c[1]),e=1;for(t=0;t<=this.p.n&&!((e*=this.r.next())<s);t++);let h=Math.min(t,this.p.n);return this.c[0]===this.p.p?h:this.p.n-h}{let t,s,e,h=this.p.n,a=g(h+1),i=1-this.c[0],r=Math.log(this.c[0]),p=Math.log(i),n=Math.sqrt(2*this.c[1]*i);do{do{s=n*(t=Math.tan(Math.PI*this.r.next()))+this.c[1]}while(s<0||s>=h+1);s=Math.floor(s),e=1.2*n*(1+t*t)*Math.exp(a-g(s+1)-g(h-s+1)+s*r+(h-s)*p)}while(this.r.next()>e);return this.c[0]===this.p.p?s:this.p.n-s}}_pdf(t){return Math.exp(L(this.p.n,t)+t*Math.log(this.p.p)+(this.p.n-t)*Math.log(1-this.p.p))}_cdf(t){return q(this.p.n-t,1+t,1-this.p.p)}},BirnbaumSaunders:class extends z{constructor(t=0,s=1,e=1){super(),this.p=Object.assign(this.p,{mu2:t,beta:s,gamma:e}),this._validate({mu:t,beta:s,gamma:e},["beta > 0","gamma > 0"]),this.s=[{value:t,closed:!1},{value:1/0,closed:!1}]}_generator(){let t=this.p.gamma*super._generator();return.25*this.p.beta*Math.pow(t+Math.sqrt(4+Math.pow(t,2)),2)+this.p.mu2}_pdf(t){let s=Math.sqrt((t-this.p.mu2)/this.p.beta);return(s+1/s)*super._pdf((s-1/s)/this.p.gamma)/(2*this.p.gamma*(t-this.p.mu2))}_cdf(t){let s=Math.sqrt((t-this.p.mu2)/this.p.beta);return super._cdf((s-1/s)/this.p.gamma)}_q(t){let s=this.p.gamma*super._q(t);return.25*this.p.beta*Math.pow(s+Math.sqrt(4+Math.pow(s,2)),2)+this.p.mu2}},BoundedPareto:class extends _{constructor(t=1,s=10,e=1){super("continuous",arguments.length),this.p={L:t,H:s,alpha:e},this._validate({L:t,H:s,alpha:e},["L > 0","H > 0","L < H","alpha > 0"]),this.s=[{value:t,closed:!0},{value:s,closed:!0}],this.c=[Math.pow(t,e),Math.pow(s,e),1-Math.pow(t/s,e)]}_generator(){return this._q(this.r.next())}_pdf(t){return this.p.alpha*Math.pow(this.p.L/t,this.p.alpha)/(t*this.c[2])}_cdf(t){return(1-this.c[0]*Math.pow(t,-this.p.alpha))/(1-this.c[0]/this.c[1])}_q(t){return Math.pow((this.c[1]+t*(this.c[0]-this.c[1]))/(this.c[0]*this.c[1]),-1/this.p.alpha)}},Bradford:class extends _{constructor(t=1){super("continuous",arguments.length),this.p={c:t},this._validate({c:t},["c > 0"]),this.s=[{value:0,closed:!0},{value:1,closed:!0}],this.c=[Math.log(1+t)]}_generator(){return this._q(this.r.next())}_pdf(t){return this.p.c/(this.c[0]*(1+this.p.c*t))}_cdf(t){return Math.log(1+this.p.c*t)/this.c[0]}_q(t){return(Math.exp(this.c[0]*t)-1)/this.p.c}},Burr:class extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={c:t,k:s},this._validate({c:t,k:s},["c > 0","k > 0"]),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){return this.p.c*this.p.k*Math.pow(t,this.p.c-1)/Math.pow(1+Math.pow(t,this.p.c),this.p.k+1)}_cdf(t){return 1-Math.pow(1+Math.pow(t,this.p.c),-this.p.k)}_q(t){return Math.pow(Math.pow(1-t,-1/this.p.k)-1,1/this.p.c)}},Categorical:b,Cauchy:B,Chi:class extends D{constructor(t=2){super(t),this.p=Object.assign(this.p,{k:t}),this._validate({k:t},["k > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return Math.sqrt(super._generator())}_pdf(t){return 1===this.p.k&&0===t?Math.sqrt(2/Math.PI):2*t*super._pdf(t*t)}_cdf(t){return super._cdf(t*t)}},Chi2:D,Dagum:Q,Degenerate:class extends _{constructor(t=0){super("continuous",arguments.length),this.p={x0:t},this.s=[{value:t,closed:!0},{value:t,closed:!0}]}_generator(){return this.p.x0}_pdf(){return 1}},DiscreteUniform:class extends _{constructor(t=0,s=100){super("discrete",arguments.length),this.p={xmin:Math.round(t),xmax:Math.round(s)},this._validate({xmin:t,xmax:s},["xmin < xmax"]),this.s=[{value:this.p.xmin,closed:!0},{value:this.p.xmax,closed:!0}],this.c=[this.p.xmax-this.p.xmin+1]}_generator(){return this._q(this.r.next())}_pdf(){return 1/this.c[0]}_cdf(t){return(1+t-this.p.xmin)/this.c[0]}_q(t){return Math.floor(t*this.c[0])+this.p.xmin}},DiscreteWeibull:class extends _{constructor(t=.5,s=1){super("discrete",arguments.length),this.p={q:t,beta:s},this._validate({q:t,beta:s},["q > 0","q < 1","beta > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){return Math.pow(this.p.q,Math.pow(t,this.p.beta))-Math.pow(this.p.q,Math.pow(t+1,this.p.beta))}_cdf(t){return 1-Math.pow(this.p.q,Math.pow(t+1,this.p.beta))}_q(t){return Math.floor(Math.pow(Math.log(1-t)/Math.log(this.p.q),1/this.p.beta))}},Erlang:class extends G{constructor(t=1,s=1){super(Math.round(t),s),this._validate({k:t,lambda:s},["k > 0","lambda > 0"])}},Exponential:U,ExponentialLogarithmic:class extends _{constructor(t=.5,s=1){super("continuous",arguments.length),this.p={p:t,beta:s},this._validate({p:t,beta:s},["p > 0","p < 1","beta > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=(1-this.p.p)*Math.exp(-this.p.beta*t);return this.p.beta*s/((s-1)*Math.log(this.p.p))}_cdf(t){return 1-Math.log(1-(1-this.p.p)*Math.exp(-this.p.beta*t))/Math.log(this.p.p)}_q(t){return(Math.log(1-this.p.p)-Math.log(1-Math.pow(this.p.p,1-t)))/this.p.beta}},F:K,FlorySchulz:class extends _{constructor(t=.5){super("discrete",arguments.length),this.p={a:t},this._validate({a:t},["a > 0","a < 1"]),this.s=[{value:1,closed:!0},{value:1/0,closed:!0}];let s=-2.5/Math.log(1-t);this.c=[1.5,s,Math.pow(s,-2.5)/Math.pow(1-t,s)]}_generator(){return y(this.r,()=>A(this.r,this.c[0]),t=>Math.pow(t,this.c[0]+1)*Math.pow(1-this.p.a,t)*this.c[2])}_pdf(t){return this.p.a*this.p.a*t*Math.pow(1-this.p.a,t-1)}_cdf(t){return 1-Math.pow(1-this.p.a,t)*(1+this.p.a*t)}},Frechet:class extends _{constructor(t=1,s=1,e=0){super("continuous",arguments.length),this.p={alpha:t,s:s,m:e},this._validate({alpha:t,s:s,m:e},["alpha > 0","s > 0"]),this.s=[{value:e,closed:!1},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=(t-this.p.m)/this.p.s;return this.p.alpha*Math.exp(-Math.log(s)*(1+this.p.alpha)-Math.pow(s,-this.p.alpha))/this.p.s}_cdf(t){return Math.exp(-Math.pow((t-this.p.m)/this.p.s,-this.p.alpha))}_q(t){return this.p.m+this.p.s*Math.pow(-Math.log(t),-1/this.p.alpha)}},FisherZ:class extends K{constructor(t=1,s=1){super(t,s),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}]}_generator(){return.5*Math.log(super._generator())}_pdf(t){return 2*super._pdf(Math.exp(2*t))*Math.exp(2*t)}_cdf(t){return super._cdf(Math.exp(2*t))}},Gamma:G,GammaGompertz:class extends _{constructor(t=1,s=1,e=1){super("continuous",arguments.length),this.p={b:t,s:s,beta:e},this._validate({b:t,s:s,beta:e},["b > 0","s > 0","beta > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=Math.exp(this.p.b*t),e=Math.pow(this.p.beta-1+s,this.p.s+1);return isFinite(s)&&isFinite(e)?this.p.b*this.p.s*Math.pow(this.p.beta,this.p.s)*s/e:0}_cdf(t){return 1-Math.pow(1+(Math.exp(this.p.b*t)-1)/this.p.beta,-this.p.s)}_q(t){return Math.log(1+this.p.beta*(Math.pow(1-t,-1/this.p.s)-1))/this.p.b}},GeneralizedGamma:class extends G{constructor(t=1,s=1,e=1){super(s/e,Math.pow(t,-e)),this.p=Object.assign(this.p,{a:t,d:s,p:e}),this._validate({a:t,d:s,p:e},["a > 0","d > 0","p > 0"]),this.s=[{value:0,closed:s>=1&&e>=1&&s>=e},{value:1/0,closed:!1}]}_generator(){return Math.pow(super._generator(),1/this.p.p)}_pdf(t){return this.p.p*Math.pow(t,this.p.p-1)*super._pdf(Math.pow(t,this.p.p))}_cdf(t){return super._cdf(Math.pow(t,this.p.p))}},GeneralizedPareto:class extends _{constructor(t=0,s=1,e=1){super("continuous",arguments.length),this.p={mu:t,sigma:s,xi:e},this._validate({mu:t,sigma:s,xi:e},["sigma > 0"]),this.s=[{value:t,closed:!0},{value:e<0?t-s/e:1/0,closed:e<0}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=(t-this.p.mu)/this.p.sigma;return 0===this.p.xi?Math.exp(-s)/this.p.sigma:Math.pow(1+this.p.xi*s,-1/this.p.xi-1)/this.p.sigma}_cdf(t){let s=(t-this.p.mu)/this.p.sigma;return 0===this.p.xi?1-Math.exp(-s):1-Math.pow(1+this.p.xi*s,-1/this.p.xi)}_q(t){let s=0===this.p.xi?-Math.log(1-t):(Math.pow(1-t,-this.p.xi)-1)/this.p.xi;return this.p.mu+this.p.sigma*s}},Geometric:class extends _{constructor(t=.5){super("discrete",arguments.length),this.p={p:t},this._validate({p:t},["p > 0","p <= 1"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){return this.p.p*Math.pow(1-this.p.p,t)}_cdf(t){return 1-Math.pow(1-this.p.p,t+1)}_q(t){return Math.floor(Math.log(1-t)/Math.log(1-this.p.p))}},Gompertz:class extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={eta:t,b:s},this._validate({eta:t,b:s},["eta > 0","b > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){return this.p.b*this.p.eta*Math.exp(this.p.eta+this.p.b*t-this.p.eta*Math.exp(this.p.b*t))}_cdf(t){return 1-Math.exp(-this.p.eta*(Math.exp(this.p.b*t)-1))}_q(t){return Math.log(1-Math.log(1-t)/this.p.eta)/this.p.b}},Gumbel:class extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,beta:s},this._validate({mu:t,beta:s},["beta > 0"]),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=(t-this.p.mu)/this.p.beta;return Math.exp(-(s+Math.exp(-s)))/this.p.beta}_cdf(t){return Math.exp(-Math.exp(-(t-this.p.mu)/this.p.beta))}_q(t){return this.p.mu-this.p.beta*Math.log(-Math.log(t))}},HalfNormal:class extends z{constructor(t=1){super(0,t),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return Math.abs(super._generator())}_pdf(t){return 2*super._pdf(t)}_cdf(t){return 2*super._cdf(t)-1}_q(t){return 1.414213562373095*this.p.sigma*H(t)}},HalfLogistic:class extends _{constructor(){super("continuous",arguments.length),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=Math.exp(-t);return 2*s/Math.pow(1+s,2)}_cdf(t){let s=Math.exp(-t);return(1-s)/(1+s)}_q(t){return-Math.log((1-t)/(1+t))}},Hoyt:class extends _{constructor(t=.5,s=1){super("continuous",arguments.length),this.p={q:t,omega:s},this._validate({q:t,omega:s},["q > 0","q <= 1","omega > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}],this.c=[2*Math.pow(this.p.q,this.p.q)/Math.pow(this.p.omega,this.p.q)]}_generator(){return Math.sqrt(k(this.r,this.p.q,this.p.q/this.p.omega))}_pdf(t){let s=Math.pow(t,2*this.p.q-1);return isFinite(s)?2*Math.exp(this.p.q*Math.log(this.p.q)-this.p.q*t*t/this.p.omega-g(this.p.q)-this.p.q*Math.log(this.p.omega))*s:0}_cdf(t){return N(this.p.q,this.p.q*t*t/this.p.omega)}},HyperbolicSecant:class extends _{constructor(){super("continuous",arguments.length),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){return.5/Math.cosh(.5*Math.PI*t)}_cdf(t){return 2*Math.atan(Math.exp(.5*Math.PI*t))/Math.PI}_q(t){return 2*Math.log(Math.tan(.5*Math.PI*t))/Math.PI}},Hypergeometric:class extends b{constructor(t=10,s=5,e=5){let h=Math.round(t),a=Math.round(s),i=Math.round(e),r=[],p=Math.max(0,i+a-h),n=Math.min(i,a);for(let t=p;t<=n;t++)r.push(Math.exp(L(a,t)+L(h-a,i-t)-L(h,i)));super(r)}},InverseChi2:class extends _{constructor(t=1){super("continuous",arguments.length),this.p={nu:Math.round(t)},this._validate({nu:Math.round(t)},["nu > 0"]),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}]}_generator(){return 1/k(this.r,Math.round(this.p.nu)/2,.5)}_pdf(t){return Math.pow(2,-this.p.nu/2)*Math.pow(t,-this.p.nu/2-1)*Math.exp(-.5/t-g(this.p.nu/2))}_cdf(t){return 1-N(this.p.nu/2,.5/t)}},InverseGamma:class extends G{constructor(t=1,s=1){super(t,s),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}],this.c=[Math.pow(s,t)]}_generator(){return 1/super._generator()}_pdf(t){return super._pdf(1/t)/(t*t)}_cdf(t){return 1-super._cdf(1/t)}},InverseGaussian:W,IrwinHall:f,JohnsonSB:class extends z{constructor(t=0,s=1,e=1,h=0){super(),this.p=Object.assign(this.p,{gamma:t,delta:s,lambda:e,xi:h}),this._validate({gamma:t,delta:s,lambda:e,xi:h},["delta > 0","lambda > 0"]),this.s=[{value:h,closed:!0},{value:h+e,closed:!0}]}_generator(){return this.p.xi+this.p.lambda/(1+Math.exp(-(super._generator()-this.p.gamma)/this.p.delta))}_pdf(t){let s=t-this.p.xi;return this.p.delta*this.p.lambda*super._pdf(this.p.gamma+this.p.delta*Math.log(s/(this.p.lambda-s)))/(s*(this.p.lambda-s))}_cdf(t){let s=t-this.p.xi;return super._cdf(this.p.gamma+this.p.delta*Math.log(s/(this.p.lambda-s)))}_q(t){return this.p.xi+this.p.lambda/(1+Math.exp(-(super._q(t)-this.p.gamma)/this.p.delta))}},JohnsonSU:class extends z{constructor(t=0,s=1,e=1,h=0){super(),this.p=Object.assign(this.p,{gamma:t,delta:s,lambda:e,xi:h}),this._validate({gamma:t,delta:s,lambda:e,xi:h},["delta > 0","lambda > 0"]),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}]}_generator(){return this.p.xi+this.p.lambda*Math.sinh((super._generator()-this.p.gamma)/this.p.delta)}_pdf(t){let s=(t-this.p.xi)/this.p.lambda;return this.p.delta*super._pdf(this.p.gamma+this.p.delta*Math.asinh(s))/(this.p.lambda*Math.sqrt(1+s*s))}_cdf(t){return super._cdf(this.p.gamma+this.p.delta*Math.asinh((t-this.p.xi)/this.p.lambda))}_q(t){return this.p.xi+this.p.lambda*Math.sinh((super._q(t)-this.p.gamma)/this.p.delta)}},Kumaraswamy:$,Laplace:V,Levy:class extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,c:s},this._validate({mu:t,c:s},["c > 0"]),this.s=[{value:t,closed:!0},{value:1/0,closed:!1}]}_generator(){let t=I(this.r,0,1/Math.sqrt(this.p.c));return this.p.mu+1/(t*t)}_pdf(t){let s=t-this.p.mu;return Math.sqrt(.5*this.p.c/Math.PI)*Math.exp(-.5*this.p.c/s-1.5*Math.log(s))}_cdf(t){return t===this.p.mu?0:T(Math.sqrt(.5*this.p.c/(t-this.p.mu)))}},Lindley:class extends _{constructor(t=1){super("continuous",arguments.length),this.p={theta:t},this._validate({theta:t},["theta > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}],this.c=[1+t,t<=2?t*Math.exp(1-t/2)/2:1]}_generator(){return y(this.r,()=>k(this.r,1,this.p.theta/2),t=>this.c[1]*(1+t)*Math.exp(-.5*this.p.theta*t))}_pdf(t){return this.p.theta*this.p.theta*(1+t)*Math.exp(-this.p.theta*t)/this.c[0]}_cdf(t){return 1-Math.exp(-this.p.theta*t)*(this.c[0]+this.p.theta*t)/this.c[0]}},Logarithmic:class extends _{constructor(t=1,s=2){super("continuous",arguments.length),this.p={a:t,b:s},this._validate({a:t,b:s},["a >= 1","b >= 1","a < b"]),this.s=[{value:t,closed:!0},{value:s,closed:!0}],this.c=[t*(1-Math.log(t)),s*(1-Math.log(s))]}_generator(){return this._q(this.r.next())}_pdf(t){return Math.log(t)/(this.c[0]-this.c[1])}_cdf(t){return(this.c[0]-t*(1-Math.log(t)))/(this.c[0]-this.c[1])}_q(t){let s=t*(this.c[0]-this.c[1])-this.c[0];return s/x(s/Math.E)}},LogCauchy:class extends B{constructor(t=0,s=1){super(t,s),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}]}_generator(){let t=super._generator();return Math.max(Math.min(Number.MAX_VALUE,Math.exp(t)),Number.MIN_VALUE)}_pdf(t){return super._pdf(Math.log(t))/t}_cdf(t){return super._cdf(Math.log(t))}_q(t){return Math.exp(super._q(t))}},LogGamma:class extends G{constructor(t=1,s=1,e=0){super(t,s),this.p=Object.assign(this.p,{mu:e}),this._validate({mu:e},["mu >= 0"]),this.s=[{value:e,closed:!0},{value:1/0,closed:!1}]}_generator(){return Math.exp(super._generator())+this.p.mu-1}_pdf(t){return super._pdf(Math.log(t-this.p.mu+1))/(t-this.p.mu+1)}_cdf(t){return super._cdf(Math.log(t-this.p.mu+1))}},Logistic:class extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,s:s},this._validate({mu:t,s:s},["s > 0"]),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}]}_generator(){return this.p.mu-this.p.s*Math.log(1/this.r.next()-1)}_pdf(t){let s=Math.exp(-(t-this.p.mu)/this.p.s);return isFinite(s*s)?s/(this.p.s*Math.pow(1+s,2)):0}_cdf(t){return 1/(1+Math.exp(-(t-this.p.mu)/this.p.s))}_q(t){return this.p.mu-this.p.s*Math.log(1/t-1)}},LogisticExponential:class extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={lambda:t,kappa:s},this._validate({lambda:t,kappa:s},["lambda > 0","kappa > 0"]),this.s=[{value:0,closed:s>=1},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){let s=Math.exp(this.p.lambda*t);return isFinite(Math.pow(s,2*this.p.kappa))?this.p.lambda*this.p.kappa*Math.pow(s-1,this.p.kappa-1)*s/Math.pow(1+Math.pow(s-1,this.p.kappa),2):0}_cdf(t){return 1-1/(1+Math.pow(Math.exp(this.p.lambda*t)-1,this.p.kappa))}_q(t){let s=Math.pow(t/(1-t),1/this.p.kappa);return 1+s===1?s/this.p.lambda:Math.log(1+s)/this.p.lambda}},LogitNormal:class extends z{constructor(t=0,s=1){super(t,s),this.s=[{value:0,closed:!1},{value:1,closed:!1}]}_generator(){return 1/(1+Math.exp(-super._generator()))}_pdf(t){return super._pdf(Math.log(t/(1-t)))/(t*(1-t))}_cdf(t){return super._cdf(Math.log(t/(1-t)))}_q(t){return 1/(1+Math.exp(-super._q(t)))}},LogLaplace:class extends V{constructor(t=0,s=1){super(t,s),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}]}_generator(){return Math.exp(super._generator())}_pdf(t){return super._pdf(Math.log(t))/t}_cdf(t){return super._cdf(Math.log(t))}_q(t){return Math.exp(super._q(t))}},LogLogistic:class extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={alpha:t,beta:s},this._validate({alpha:t,beta:s},["alpha > 0","beta > 0"]),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}],this.c=[s/t]}_generator(){return this._q(this.r.next())}_pdf(t){let s=t/this.p.alpha,e=Math.pow(s,this.p.beta-1);return this.c[0]*e/Math.pow(1+s*e,2)}_cdf(t){return 1/(1+Math.pow(t/this.p.alpha,-this.p.beta))}_q(t){return this.p.alpha*Math.pow(1/t-1,-1/this.p.beta)}},LogNormal:class extends z{constructor(t=0,s=1){super(t,s),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}]}_generator(){return Math.exp(super._generator())}_pdf(t){return super._pdf(Math.log(t))/t}_cdf(t){return super._cdf(Math.log(t))}_q(t){return Math.exp(super._q(t))}},LogSeries:class extends _{constructor(t=.5){super("discrete",arguments.length),this.p={p:t},this._validate({p:t},["p > 0","p < 1"]),this.s=[{value:1,closed:!0},{value:1/0,closed:!1}]}_generator(){return Math.floor(1+Math.log(this.r.next())/Math.log(1-Math.pow(1-this.p.p,this.r.next())))}_pdf(t){return-Math.pow(this.p.p,t)/(t*Math.log(1-this.p.p))}_cdf(t){return 1+function(t,s,e){let h=e<=0||e>=1?0:Math.exp(t*Math.log(e)+s*Math.log(1-e));return 0!==t&&(e<(t+1)/(t+s+2)||0===s)?h*w(t,s,e)/t:1-h*w(s,t,1-e)/s}(t+1,0,this.p.p)/Math.log(1-this.p.p)}},Lomax:class extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={lambda:t,alpha:s},this._validate({lambda:t,alpha:s},["lambda > 0","alpha > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){return this.p.alpha*Math.pow(1+t/this.p.lambda,-1-this.p.alpha)/this.p.lambda}_cdf(t){return 1-Math.pow(1+t/this.p.lambda,-this.p.alpha)}_q(t){return this.p.lambda*(Math.pow(1-t,-1/this.p.alpha)-1)}},Makeham:class extends _{constructor(t=1,s=1,e=1){super("continuous",arguments.length),this.p={alpha:t,beta:s,lambda:e},this._validate({alpha:t,beta:s,lambda:e},["alpha > 0","beta > 0","lambda > 0"]),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}],this.c=[t/(s*e),t*Math.exp(t/e)/e,-s/e]}_generator(){return this._q(this.r.next())}_pdf(t){let s=Math.exp(this.p.beta*t);return isFinite(Math.exp(s))?(this.p.alpha*s+this.p.lambda)*Math.exp(-this.p.lambda*t-this.p.alpha*(s-1)/this.p.beta):0}_cdf(t){return 1-Math.exp(-this.p.lambda*t-this.p.alpha*(Math.exp(this.p.beta*t)-1)/this.p.beta)}_q(t){let s=x(this.c[1]*Math.pow(1-t,this.c[2]));if(isFinite(s))return this.c[0]-Math.log(1-t)/this.p.lambda-s/this.p.beta;{let s=Math.log(this.c[1])+this.c[2]*Math.log(1-t);return this.c[0]-Math.log(1-t)/this.p.lambda-(s-Math.log(s))/this.p.beta}}},MaxwellBoltzmann:class extends G{constructor(t=1){super(1.5,2*t*t),this._validate({a:t},["a > 0"])}},Mielke:class extends Q{constructor(t=2,s=1){super(t/s,s,1),this._validate({k:t,s:s},["k > 0","s > 0"]),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}]}},Moyal:class extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,sigma:s},this._validate({mu:t,sigma:s},["sigma > 0"]),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}],this.c=[s*Math.sqrt(2*Math.PI)]}_generator(){return y(this.r,()=>Math.PI*this.r.next()-Math.PI/2,t=>{let s=Math.tan(t);return Math.exp(-.5*(s+Math.exp(-s)))/(Math.sqrt(2*Math.PI)*Math.pow(Math.cos(t),2))},t=>this.p.sigma*Math.tan(t)+this.p.mu)}_pdf(t){let s=(t-this.p.mu)/this.p.sigma;return Math.exp(-.5*(s+Math.exp(-s)))/this.c[0]}_cdf(t){return 1-N(.5,.5*Math.exp((this.p.mu-t)/this.p.sigma))}},Nakagami:class extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={m:t,omega:s},this._validate({m:t,omega:s},["m >= 0.5","omega > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}],this.c=[2*Math.pow(this.p.m,this.p.m)/Math.pow(this.p.omega,this.p.m)]}_generator(){return Math.sqrt(k(this.r,this.p.m,this.p.m/this.p.omega))}_pdf(t){return this.c[0]*Math.pow(t,2*this.p.m-1)*Math.exp(-this.p.m*t*t/this.p.omega-g(this.p.m))}_cdf(t){return N(this.p.m,this.p.m*t*t/this.p.omega)}},NegativeBinomial:class extends _{constructor(t=10,s=.5){super("discrete",arguments.length),this.p={r:Math.round(t),p:s},this._validate({r:t,p:s},["r > 0","p >= 0","p <= 1"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return P(this.r,k(this.r,this.p.r,1/this.p.p-1))}_pdf(t){return Math.exp(L(t+this.p.r-1,t)+this.p.r*Math.log(1-this.p.p)+t*Math.log(this.p.p))}_cdf(t){return 1-q(t+1,this.p.r,this.p.p)}},NegativeHypergeometric:class extends b{constructor(t=10,s=5,e=5){let h=Math.round(t),a=Math.round(s),i=Math.round(e),r=[];for(let t=0;t<=a;t++)r.push(Math.exp(L(a+i-1,t)+L(h-i-t,a-t)-L(h,a)));super(r),this._validate({N:h,K:a,r:i},["N >= 0","K > 0","K <= N","r > 0","r <= N - K"])}},NoncentralChi:class extends st{constructor(t=2,s=1){super(t,s*s),this._validate({k:t,lambda:s},["lambda > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return Math.sqrt(super._generator())}_pdf(t){return 2*t*super._pdf(t*t)}_cdf(t){return super._cdf(t*t)}},NoncentralChi2:st,Normal:z,Pareto:class extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={xmin:t,alpha:s},this._validate({xmin:t,alpha:s},["xmin > 0","alpha > 0"]),this.s=[{value:t,closed:!0},{value:1/0,closed:!1}]}_generator(){return this._q(this.r.next())}_pdf(t){return this.p.alpha*Math.pow(this.p.xmin/t,this.p.alpha)/t}_cdf(t){return 1-Math.pow(this.p.xmin/t,this.p.alpha)}_q(t){return this.p.xmin/Math.pow(1-t,1/this.p.alpha)}},PERT:class extends R{constructor(t=0,s=.5,e=1){super((4*s+e-5*t)/(e-t),(5*e-t-4*s)/(e-t)),this.p=Object.assign(this.p,{a:t,b:s,c:e}),this._validate({a:t,b:s,c:e},["a < b","b < c"]),this.s=[{value:t,closed:!0},{value:e,closed:!0}]}_generator(){return super._generator()*(this.p.c-this.p.a)+this.p.a}_pdf(t){return super._pdf((t-this.p.a)/(this.p.c-this.p.a))/(this.p.c-this.p.a)}_cdf(t){return super._cdf((t-this.p.a)/(this.p.c-this.p.a))}},Poisson:class extends _{constructor(t=1){super("discrete",arguments.length),this.p={lambda:t},this._validate({lambda:t},["lambda > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}]}_generator(){return P(this.r,this.p.lambda)}_pdf(t){return Math.pow(this.p.lambda,t)*Math.exp(-this.p.lambda-g(t+1))}_cdf(t){return 1-N(t+1,this.p.lambda)}},PowerLaw:class extends ${constructor(t=1){super(t,1)}},Rademacher:class extends b{constructor(){super([.5,0,.5],-1)}_q(t){return t>.5?1:-1}},RaisedCosine:class extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={mu:t,s:s},this._validate({mu:t,s:s},["s > 0"]),this.s=[{value:t-s,closed:!0},{value:t+s,closed:!0}]}_generator(){return y(this.r,()=>{let t=I(this.r,this.p.mu,this.p.s);for(;t<this.p.mu-this.p.s||t>this.p.mu+this.p.s;)t=I(this.r,this.p.mu,this.p.s);return t},t=>{let s=(t-this.p.mu)/this.p.s;return.5*(1+Math.cos(Math.PI*s)*Math.exp(.5*s*s))})}_pdf(t){return.5*(1+Math.cos(Math.PI*(t-this.p.mu)/this.p.s))/this.p.s}_cdf(t){let s=(t-this.p.mu)/this.p.s;return.5*(1+s+Math.sin(Math.PI*s)/Math.PI)}},Rayleigh:class extends et{constructor(t=1){super(t*Math.SQRT2,2)}},Reciprocal:class extends _{constructor(t=1,s=2){super("continuous",arguments.length),this.p={a:t,b:s},this._validate({a:t,b:s},["a > 0","b > 0","a < b"]),this.s=[{value:t,closed:!0},{value:s,closed:!0}],this.c=[Math.log(t),Math.log(s)]}_generator(){return this.p.a*Math.exp((this.c[1]-this.c[0])*this.r.next())}_pdf(t){return 1/(t*(this.c[1]-this.c[0]))}_cdf(t){return(Math.log(t)-this.c[0])/(this.c[1]-this.c[0])}},ReciprocalInverseGaussian:class extends W{constructor(t=1,s=1){super(t,s),this.s=[{value:0,closed:!1},{value:1/0,closed:!1}]}_generator(){return 1/super._generator()}_pdf(t){return super._pdf(1/t)/(t*t)}_cdf(t){return 1-super._cdf(1/t)}},Rice:class extends _{constructor(t=1,s=1){super("continuous",arguments.length),this.p={nu:t,sigma:s},this._validate({nu:t,sigma:s},["nu > 0","sigma > 0"]),this.s=[{value:0,closed:!0},{value:1/0,closed:!1}],this.c=[.5*Math.pow(t/s,2),s*s,t/(s*s),t*t]}_generator(){let t=P(this.r,this.c[0]),s=k(this.r,t+1,.5);return this.p.sigma*Math.sqrt(s)}_pdf(t){let s=t*this.p.nu/this.c[1],e=Z(0,s);return isFinite(e)?t*Math.exp(-.5*(t*t+this.c[3])/this.c[1])*Z(0,t*this.c[2])/this.c[1]:t*Math.exp(-.5*(t*t+this.c[3])/this.c[1]+s-.5*Math.log(2*Math.PI*s))/this.c[1]}_cdf(t){return 1-tt(1,this.c[0],Math.pow(t/this.p.sigma,2)/2)}},ShiftedLogLogistic:class extends _{constructor(t=0,s=1,e=1){super("continuous",arguments.length),this.p={mu:t,sigma:s,xi:e},this._validate({mu:t,sigma:s,xi:e},["sigma > 0"]),this.s=0===e?[{value:-1/0,closed:!1},{value:1/0,closed:!1}]:[{value:e>0?t-s/e:-1/0,closed:e>0},{value:e<0?t-s/e:1/0,closed:e<0}]}_generator(){return this._q(this.r.next())}_pdf(t){if(0===this.p.xi){let s=Math.exp(-(t-this.p.mu)/this.p.sigma);return isFinite(s*s)?s/(this.p.sigma*Math.pow(1+s,2)):0}{let s=(t-this.p.mu)/this.p.sigma;return Math.pow(1+this.p.xi*s,-(1/this.p.xi+1))/(this.p.sigma*Math.pow(1+Math.pow(1+this.p.xi*s,-1/this.p.xi),2))}}_cdf(t){if(0===this.p.xi)return 1/(1+Math.exp(-(t-this.p.mu)/this.p.sigma));{let s=(t-this.p.mu)/this.p.sigma,e=Math.pow(1+this.p.xi*s,-1/this.p.xi);return isFinite(e)?1/(1+e):0}}_q(t){return 0===this.p.xi?this.p.mu-this.p.sigma*Math.log(1/t-1):this.p.mu+this.p.sigma*(Math.pow(1/t-1,-this.p.xi)-1)/this.p.xi}},Skellam:class extends _{constructor(t=1,s=1){super("discrete",arguments.length),this.p={mu1:t,mu2:s},this._validate({mu1:t,mu2:s},["mu1 > 0","mu2 > 0"]),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}],this.c=[Math.exp(-t-s),Math.sqrt(t/s),2*Math.sqrt(t*s),tt(1,s,t)]}_generator(){return P(this.r,this.p.mu1)-P(this.r,this.p.mu2)}_pdf(t){return this.c[0]*Math.pow(this.c[1],t)*Z(Math.abs(t),this.c[2])}_cdf(t){return t<=-1?1-tt(-t,this.p.mu1,this.p.mu2):t>=1?tt(t+1,this.p.mu2,this.p.mu1):this.c[3]}_q(t){return Math.floor(this._qEstimateRoot(t))}},Slash:class extends z{constructor(){super(0,1),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}],this.c1=[.5/Math.sqrt(2*Math.PI)]}_generator(){return super._generator()/this.r.next()}_pdf(t){return 0===t?this.c1[0]:(super._pdf(0)-super._pdf(t))/(t*t)}_cdf(t){return 0===t?.5:super._cdf(t)-(super._pdf(0)-super._pdf(t))/t}_q(t){let s=super._q(t);return this._qEstimateRoot(t,s)}},Soliton:class extends b{constructor(t=10){super([1/t].concat(Array.from({length:t-2},(t,s)=>1/((s+1)*(s+2)))),1),this._validate({N:t},["N > 0"])}},StudentT:class extends _{constructor(t=1){super("continuous",arguments.length),this.p={nu:t},this._validate({nu:t},["nu > 0"]),this.s=[{value:-1/0,closed:!1},{value:1/0,closed:!1}]}_generator(){return function(t,s=.5){return t.next()<s?1:-1}(this.r)*Math.sqrt(this.p.nu*k(this.r,.5)/k(this.r,this.p.nu/2))}_pdf(t){return Math.pow(1+t*t/this.p.nu,-.5*(this.p.nu+1))/(Math.sqrt(this.p.nu)*v(.5,this.p.nu/2))}_cdf(t){return t>0?1-.5*q(this.p.nu/2,.5,this.p.nu/(t*t+this.p.nu)):.5*q(this.p.nu/2,.5,this.p.nu/(t*t+this.p.nu))}},Triangular:class extends _{constructor(t=0,s=1,e=.5){super("continuous",arguments.length),this.p={a:t,b:s,c:e},this._validate({a:t,b:s,c:e},["a < b","a <= c","c <= b"]),this.s=[{value:t,closed:!0},{value:s,closed:!0}]}_generator(){return this._q(this.r.next())}_pdf(t){return t<this.p.c?2*(t-this.p.a)/((this.p.b-this.p.a)*(this.p.c-this.p.a)):2*(this.p.b-t)/((this.p.b-this.p.a)*(this.p.b-this.p.c))}_cdf(t){return t<this.p.c?Math.pow(t-this.p.a,2)/((this.p.b-this.p.a)*(this.p.c-this.p.a)):1-Math.pow(this.p.b-t,2)/((this.p.b-this.p.a)*(this.p.b-this.p.c))}_q(t){return t<(this.p.c-this.p.a)/(this.p.b-this.p.a)?this.p.a+Math.sqrt(t*(this.p.b-this.p.a)*(this.p.c-this.p.a)):this.p.b-Math.sqrt((1-t)*(this.p.b-this.p.a)*(this.p.b-this.p.c))}},Uniform:class extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={xmin:t,xmax:s},this._validate({xmin:t,xmax:s},["xmin < xmax"]),this.s=[{value:t,closed:!0},{value:s,closed:!0}],this.c=[s-t]}_generator(){return this._q(this.r.next())}_pdf(){return 1/this.c[0]}_cdf(t){return(t-this.p.xmin)/this.c[0]}_q(t){return t*this.c[0]+this.p.xmin}},UQuadratic:class extends _{constructor(t=0,s=1){super("continuous",arguments.length),this.p={a:t,b:s},this._validate({a:t,b:s},["a < b"]),this.s=[{value:t,closed:!0},{value:s,closed:!0}],this.c=[12/Math.pow(s-t,3),(t+s)/2,Math.pow((s-t)/2,3)]}_generator(){return this._q(this.r.next())}_pdf(t){return this.c[0]*Math.pow(t-this.c[1],2)}_cdf(t){return this.c[0]*(Math.pow(t-this.c[1],3)+this.c[2])/3}_q(t){return Math.cbrt(3*t/this.c[0]-this.c[2])+this.c[1]}},Weibull:et,Wigner:class extends _{constructor(t=1){super("continuous",arguments.length),this.p={R:t},this._validate({R:t},["R > 0"]),this.s=[{value:-t,closed:!0},{value:t,closed:!0}]}_generator(){let t=k(this.r,1.5,1),s=k(this.r,1.5,1);return 2*this.p.R*t/(t+s)-this.p.R}_pdf(t){let s=this.p.R*this.p.R;return 2*Math.sqrt(s-t*t)/(Math.PI*s)}_cdf(t){let s=this.p.R*this.p.R;return.5+t*Math.sqrt(s-t*t)/(Math.PI*s)+Math.asin(t/this.p.R)/Math.PI}},YuleSimon:class extends _{constructor(t=2){super("discrete",arguments.length),this.p={rho:t},this._validate({rho:t},["rho > 0"]),this.s=[{value:1,closed:!0},{value:1/0,closed:!1}],this.c=[this.p.rho+1]}_generator(){let t=-Math.log(this.r.next()),s=-Math.log(this.r.next()),e=Math.exp(-s/this.p.rho);return 1-e==1?Math.ceil(t/e):Math.ceil(-t/Math.log(1-e))}_pdf(t){return this.p.rho*v(t,this.c[0])}_cdf(t){return 1-t*v(t,this.c[0])}},Zeta:class extends _{constructor(t=2){super("discrete",arguments.length),this.p={s:t},this._validate({s:t},["s > 1"]),this.s=[{value:1,closed:!0},{value:1/0,closed:!1}],this.c=[ht(t),Math.pow(2,t-1)]}_generator(){return A(this.r,this.p.s)}_pdf(t){return Math.pow(t,-this.p.s)/this.c[0]}_cdf(t){return it(t,this.p.s)/this.c[0]}},Zipf:class extends b{constructor(t=1,s=100){let e=Math.round(s);super(Array.from({length:e},(s,e)=>Math.pow(e+1,-t)),1),this._validate({s:t,N:e},["s >= 0","N > 0"])}}});var pt=Object.freeze({Cov:class{constructor(t=1){this.dim=t,this.n=0,this.x=new Array(this.dim).fill(0),this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}reset(){this.n=0,this.x=new Array(this.dim).fill(0),this.xy=Array.from({length:this.dim},()=>new Array(this.dim).fill(0))}update(t){this.x=this.x.map((s,e)=>(this.n*s+t[e])/(this.n+1)),this.xy=this.xy.map((s,e)=>s.map((s,h)=>(this.n*s+t[e]*t[h])/(this.n+1))),this.n++}compute(){return new r(this.xy.map((t,s)=>t.map((t,e)=>t-this.x[s]*this.x[e])))}},AC:class{constructor(t=1,s=100,e=1e4){this.dim=t,this.range=s,this.maxSize=e,this.history=Array.from({length:t},()=>[])}_aci(t){let s=t.reduce((t,s)=>t+s)/t.length,e=t.reduce((t,s)=>t+s*s),h=new Array(this.range).fill(0);for(let e=0;e<t.length;e++)for(let a=0;a<h.length;a++)e-a>0&&(h[a]+=(t[e]-s)*(t[e-a]-s));return h.map(function(h){return h/(e-t.length*s*s)})}reset(){this.history=Array.from({length:this.dim},()=>[])}update(t){this.history.forEach((s,e)=>s.push(t[e])),this.history[0].length>=this.maxSize&&this.history.forEach(t=>t.shift())}compute(){return this.history.reduce((t,s)=>t+s.length,0)>0?this.history.map(t=>this._aci(t)):Array.from({length:this.dim},()=>Array.from({length:this.range},()=>void 0))}}});const nt=1e4;function lt(t,s=1){return 1===s?t.reduce((t,s)=>t+s,0):t.reduce((t,e)=>t+Math.pow(e,s),0)}let ut=function(){return function(t,s){return t[0][0].map(function(e,h){return new Array(s||1e3).fill(0).map(function(s,e){return function(t,s){let e=[],h=[];t.forEach(function(t){let a=t.map(function(t){return t[s]}),i=lt(a)/a.length,r=(lt(a,2)-a.length*i*i)/(a.length-1);e.push(i),h.push(r)});let a=lt(h)/t.length,i=lt(e)/t.length,r=(lt(e,2)-t.length*i*i)*t[0].length/(t.length-1),p=((t[0].length-1)*a+r)/t[0].length;return Math.sqrt(p/a)}(t.map(function(t){return t.slice(0,e+2)}),h)})})}}();class ot{constructor(t,s={},e={}){this.dim=s.dim||1,this.maxHistory=s.maxHistory||nt,this.lnp=t,this.x=e.x||Array.from({length:this.dim},Math.random),this.samplingRate=e.samplingRate||1,this.internal=e.internal||{},this.history=function(t){let s=Array.from({length:t.dim},()=>[]);return{get:()=>s,update(e){s.forEach((t,s)=>t.push(e[s])),s[0].length>=t.maxHistory&&s.forEach(t=>t.shift())}}}(this),this.acceptance=function(t){let s=[];return{compute(){},update(e){s.push(e),s.length>t.maxHistory&&s.shift()}}}(this)}_internal(){throw Error("MCMC._internal() is not implemented")}_iter(){throw Error("MCMC._iter() is not implemented")}_adjust(){throw Error("MCMC._adjust() is not implemented")}state(){return{x:this.x,samplingRate:this.samplingRate,internals:this._internal()}}statistics(){return this.history.get().map(t=>{let s=t.reduce((t,s)=>t+s,0)/t.length,e=t.reduce((t,e)=>t+(e-s)*(e-s),0)/t.length;return{mean:s,std:e,cv:e/s}})}ar(){return this.acceptance.compute()}ac(){return this.history.get().map(t=>{let s=t.reduce((t,s)=>t+s)/t.length,e=t.reduce((t,s)=>t+s*s),h=new Array(100).fill(0);for(let e=0;e<t.length;e++)for(let a=0;a<h.length;a++)e-a>0&&(h[a]+=(t[e]-s)*(t[e-a]-s));return h.map(function(h){return h/(e-t.length*s*s)})})}iterate(t=null,s=!1){let e=this._iter(this.state.x,s);return this.history.update(e.x),this.acceptance.update(e.accepted),this.x=e.x,t&&t(e.x,e.accepted),e}warmUp(t,s=100){for(let e=0;e<=s;e++){for(let t=0;t<1e4;t++)this._adjust(this.iterate(null,!0));let h=this.ac().reduce((t,s)=>{for(let e=0;e<s.length-1;e++)if(Math.abs(s[e])<=.05)return Math.max(t,e)},0);h>this.samplingRate?this.samplingRate++:h<this.samplingRate&&this.samplingRate>1&&this.samplingRate--,void 0!==t&&t(100*e/s)}}sample(t,s=1e3){let e=this.samplingRate*s,h=e/100,a=[];for(let s=0;s<e;s++)this.iterate(),s%h==0&&void 0!==t&&t(s/h),s%this.samplingRate==0&&a.push(this.x);return a}}var ct=Object.freeze({gr:ut,RWM:class extends ot{constructor(t,s,e){super(t,s,e),this.lastLnp=this.lnp(this.x),this.proposal=function(t){let s=new z(0,1),e=new Array(t.dim).fill(0),h=t.internal.proposal||new Array(t.dim).fill(1),a=h.map(t=>Math.log(t)),i=0,r=0,p=0;return{jump:(t,e)=>e?t.map((t,e)=>t+(e===p?s.sample()*h[p]:0)):t.map((t,e)=>t+s.sample()*h[e]),update(s){s&&e[p]++,100==++i&&(e[p]/100>.44?a[p]+=Math.min(.01,Math.pow(r,-.5)):a[p]-=Math.min(.01,Math.pow(r,-.5)),h[p]=Math.exp(a[p]),i=0,e[p]=0,0==(p=(p+1)%t.dim)&&r++)},scales:()=>h.slice()}}(this)}_internal(){return{proposal:this.proposal.scales()}}_iter(t){let s=this.proposal.jump(this.x,t),e=this.lnp(s),h=Math.random()<Math.exp(e-this.lastLnp);return h?this.lastLnp=e:s=this.x,{x:s,accepted:h}}_adjust(t){this.proposal.update(t.accepted)}}});t.core=a,t.dist=rt,t.la=p,t.mc=ct,t.ts=pt,Object.defineProperty(t,"__esModule",{value:!0})});
