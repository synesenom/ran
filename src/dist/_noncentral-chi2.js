import poisson from './_poisson'
import gamma from './_gamma'

/**
 * Generates a non-central chi2 random variate.
 *
 * @method noncentralChi2
 * @memberof ran.dist
 * @param {ran.core.Xoshiro128p} r Random generator.
 * @param {number} k Degrees of freedom.
 * @param {number} lambda Non-centrality parameter.
 * @returns {number} Random variate.
 * @ignore
 */
export default function (r, k, lambda) {
  // Generated by a compound Poisson
  const j = poisson(r, lambda / 2)
  return gamma(r, k / 2 + j, 0.5)
}
